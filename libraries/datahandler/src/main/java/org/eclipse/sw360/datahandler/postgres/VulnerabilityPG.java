package org.eclipse.sw360.datahandler.postgres;

import java.io.Serializable;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.UUID;
import org.eclipse.sw360.datahandler.componentsApi.model.VulnerabilityAPI;
import org.hibernate.annotations.Fetch;
import org.hibernate.annotations.FetchMode;
import org.hibernate.annotations.JdbcTypeCode;
import org.hibernate.type.SqlTypes;
import com.fasterxml.jackson.annotation.JsonInclude;
import jakarta.persistence.*;
import jakarta.transaction.Transactional;
import com.fasterxml.jackson.annotation.JsonInclude.Include;

@JsonInclude(value = Include.NON_EMPTY, content = Include.NON_NULL)
@Entity
@Table(name = "vulnerabilities")
@Transactional
public class VulnerabilityPG extends VulnerabilityAPI implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID id;

    @Column(name = "name", nullable = true)
    private String name;

    @Column(name = "description")
    private String description;

    @Column(name = "severity")
    private String severity;

    @Column(name = "created_at")
    private java.time.LocalDateTime createdAt;

    @Column(name = "updated_at")
    private java.time.LocalDateTime updatedAt;

    @Column(name = "priority")
    private String priority;

    @Column(name = "priority_text")
    private String priorityText;

    @Column(name = "action")
    private String action;

    @Column(name = "impact")
    @JdbcTypeCode(SqlTypes.JSON)
    private Map<String, String> impact;

    @Column(name = "legal_notice")
    private String legalNotice;

    @Column(name = "assigned_ext_component_ids")
    @JdbcTypeCode(SqlTypes.JSON)
    private List<String> assignedExtComponentIds;

    @Column(nullable = true)
    @JdbcTypeCode(SqlTypes.JSON)
    private List<String> cveReferences;

    @Column(nullable = true)
    @JdbcTypeCode(SqlTypes.JSON)
    private List<String> vendorAdvisories;

    @Column(nullable = true)
    private String extendedDescription;

    @Column(name = "cvss")
    private String cvss;

    @Column(name = "is_set_cvss")
    private String isSetCvss;

    @Column(name = "cvss_time")
    private String cvssTime;

    @Column(name = "vulnerable_configuration")
    @JdbcTypeCode(SqlTypes.JSON)
    private Map<String, String> vulnerableConfiguration;

    @Column(name = "access")
    @JdbcTypeCode(SqlTypes.JSON)
    private Map<String, String> access;

    @Column(name = "cwe")
    private String cwe;

    @Column(name = "cve_further_meta_data_per_source")
    @JdbcTypeCode(SqlTypes.JSON)
    private Map<String, Map<String, String>> cveFurtherMetaDataPerSource;

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "vulnerability")
    @Fetch(FetchMode.JOIN)
    private Set<VulnerabilityReleaseRelationPG> releases;

    @Column(name = "external_ids")
    private String externalIds;

    @Column(name = "additional_data")
    private String additionalData;

    @Column(name = "roles")
    private String roles;

    @Column(name = "type")
    private String type;

    @Column(name = "last_update_date")
    private String lastUpdateDate;

    @Column(name = "external_id")
    private String externalId;

    @Column(name = "title")
    private String title;

    @Column(name = "publish_date")
    private String publishDate;

    @Column(name = "last_external_update")
    private String lastExternalUpdate;

    @Column(name = "revision")
    private String revision;

    public UUID getId() {
        return id;
    }

    public void setId(UUID id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public java.time.LocalDateTime getCreatedAt() {
        return createdAt;
    }

    public void setCreatedAt(java.time.LocalDateTime createdAt) {
        this.createdAt = createdAt;
    }

    public java.time.LocalDateTime getUpdatedAt() {
        return updatedAt;
    }

    public void setUpdatedAt(java.time.LocalDateTime updatedAt) {
        this.updatedAt = updatedAt;
    }

    public String getPriority() {
        return priority;
    }

    public void setPriority(String priority) {
        this.priority = priority;
    }

    public String getPriorityText() {
        return priorityText;
    }

    public void setPriorityText(String priorityText) {
        this.priorityText = priorityText;
    }

    public String getAction() {
        return action;
    }

    public void setAction(String action) {
        this.action = action;
    }

    public Map<String, String> getImpact() {
        return impact;
    }

    public void setImpact(Map<String, String> impact) {
        this.impact = impact;
    }

    public String getLegalNotice() {
        return legalNotice;
    }

    public void setLegalNotice(String legalNotice) {
        this.legalNotice = legalNotice;
    }

    public Set<VulnerabilityReleaseRelationPG> getReleasesRelation() {
        return releases;
    }

    public void setReleasesRelation(Set<VulnerabilityReleaseRelationPG> releases) {
        this.releases = releases;
    }

    public List<String> getAssignedExtComponentIds() {
        return assignedExtComponentIds;
    }

    public void setAssignedExtComponentIds(List<String> assignedExtComponentIds) {
        this.assignedExtComponentIds = assignedExtComponentIds;
    }

    public List<String> getCveReferences() {
        return cveReferences;
    }

    public void setCveReferences(List<String> cveReferences) {
        this.cveReferences = cveReferences;
    }

    public List<String> getVendorAdvisories() {
        return vendorAdvisories;
    }

    public void setVendorAdvisories(List<String> vendorAdvisories) {
        this.vendorAdvisories = vendorAdvisories;
    }

    public String getExtendedDescription() {
        return extendedDescription;
    }

    public void setExtendedDescription(String extendedDescription) {
        this.extendedDescription = extendedDescription;
    }

    public String getCvss() {
        return cvss;
    }

    public void setCvss(String cvss) {
        this.cvss = cvss;
    }

    public String getIsSetCvss() {
        return isSetCvss;
    }

    public void setIsSetCvss(String isSetCvss) {
        this.isSetCvss = isSetCvss;
    }

    public String getCvssTime() {
        return cvssTime;
    }

    public void setCvssTime(String cvssTime) {
        this.cvssTime = cvssTime;
    }

    public Map<String, String> getVulnerableConfiguration() {
        return vulnerableConfiguration;
    }

    public void setVulnerableConfiguration(Map<String, String> vulnerableConfiguration) {
        this.vulnerableConfiguration = vulnerableConfiguration;
    }

    public Map<String, String> getAccess() {
        return access;
    }

    public void setAccess(Map<String, String> access) {
        this.access = access;
    }

    public String getCwe() {
        return cwe;
    }

    public void setCwe(String cwe) {
        this.cwe = cwe;
    }

    public Map<String, Map<String, String>> getCveFurtherMetaDataPerSource() {
        return cveFurtherMetaDataPerSource;
    }

    public void setCveFurtherMetaDataPerSource(
            Map<String, Map<String, String>> cveFurtherMetaDataPerSource) {
        this.cveFurtherMetaDataPerSource = cveFurtherMetaDataPerSource;
    }

    public String getExternalIds() {
        return externalIds;
    }

    public void setExternalIds(String externalIds) {
        this.externalIds = externalIds;
    }

    public String getAdditionalData() {
        return additionalData;
    }

    public void setAdditionalData(String additionalData) {
        this.additionalData = additionalData;
    }

    public String getRoles() {
        return roles;
    }

    public void setRoles(String roles) {
        this.roles = roles;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public String getLastUpdateDate() {
        return lastUpdateDate;
    }

    public void setLastUpdateDate(String lastUpdateDate) {
        this.lastUpdateDate = lastUpdateDate;
    }

    public String getExternalId() {
        return externalId;
    }

    public void setExternalId(String externalId) {
        this.externalId = externalId;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getPublishDate() {
        return publishDate;
    }

    public void setPublishDate(String publishDate) {
        this.publishDate = publishDate;
    }

    public String getLastExternalUpdate() {
        return lastExternalUpdate;
    }

    public void setLastExternalUpdate(String lastExternalUpdate) {
        this.lastExternalUpdate = lastExternalUpdate;
    }

    public String getRevision() {
        return revision;
    }

    public void setRevision(String revision) {
        this.revision = revision;
    }

    public VulnerabilityPG() {
        // Default constructor
    }

    public VulnerabilityPG(VulnerabilityAPI vulnerability) {
        this.description = vulnerability.getDescription();
        this.priority = vulnerability.getPriority();
        this.priorityText = vulnerability.getPriorityText();
        this.action = vulnerability.getAction();
        this.impact = vulnerability.getImpact();
        this.legalNotice = vulnerability.getLegalNotice();
        this.assignedExtComponentIds = vulnerability.getAssignedExtComponentIds();
        this.cveReferences = vulnerability.getCveReferences();
        this.vendorAdvisories = vulnerability.getVendorAdvisories();
        this.extendedDescription = vulnerability.getExtendedDescription();
        this.cvss = vulnerability.getCvss();
        this.isSetCvss = vulnerability.getIsSetCvss();
        this.cvssTime = vulnerability.getCvssTime();
        this.vulnerableConfiguration = vulnerability.getVulnerableConfiguration();
        this.access = vulnerability.getAccess();
        this.cwe = vulnerability.getCwe();
        this.cveFurtherMetaDataPerSource = vulnerability.getCveFurtherMetaDataPerSource();
        this.type = vulnerability.getType();
    }
}
